<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ajax</title>
    <script type="text/javascript">
        function creatXMLHttpRequest(){
            var request=false;
            if(window.XMLHttpRequest){               //对非ie浏览器直接使用XHR
                request = new XMLHttpRequest();
                if(request.overrideMimeType){           //若当前浏览器没有指定MimeType类型，则指定为xml
                    request.overrideMimeType("text/xml");
                }
            }else if(window.AcctiveXObject){          //对ie浏览器
                //将所有ie版本存在一个数组中
                var versions=['Microsoft.XMLHTTP','MSXML.XMLHTTP','Microsoft.XMLHTTP',
                'Msxml2.XMLHTTP.7.0','Msxml2.XMLHTTP.6.0','Msxml2.XMLHTTP.5.0','Msxml2.XMLHTTP.4.0',
                'MSXML2.XMLHTTP.3.0','MSXML2.XMLHTTP'];
                for(var i=0;i<versions.length;i++){
                    try {
                        request=new AcctiveXObject(versions[i]);
                        if(request){                             //有创建成功适合当前浏览器的request对象就返回request
                            return request;
                        }
                    }catch (e) {
                        request=false;
                    }
                }
            }
            return request;
        }

        var ajax=creatXMLHttpRequest();
        console.log(creatAjaxObject);
    </script>
</head>
<body>

</body>
</html>